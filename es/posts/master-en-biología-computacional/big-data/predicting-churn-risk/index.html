<!doctype html><html><head><title>Predicting Churn Risk</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href=/google-fonts/Mulish/mulish.css><link rel=stylesheet href=/fontawesome/css/all.min.css><link rel=stylesheet href=/css/colortheme/colortheme.css><link rel=icon type=image/png href=/images/new-favicon_hucdd21eecb8229141dd7886643601b174_45610_42x0_resize_box_3.png><meta property="og:title" content="Predicting Churn Risk"><meta property="og:description" content="Your goal is to create a model that can predict whether a customer will churn (0 or 1) based on the features in this dataset. See the slides for more information.
Initial Steps First, we need to create the Spark Session
!apt-get install openjdk-8-jdk-headless -qq > /dev/null !wget -q https://mirrors.sonic.net/apache/spark/spark-3.1.2/spark-3.1.2-bin-hadoop3.2.tgz !tar xzf spark-3.1.2-bin-hadoop3.2.tgz !pip install -q findspark import os os.environ[&#34;JAVA_HOME&#34;] = &#34;/usr/lib/jvm/java-8-openjdk-amd64&#34; os.environ[&#34;SPARK_HOME&#34;] = &#34;/content/spark-3.1.2-bin-hadoop3.2&#34; import findspark findspark.init() from pyspark.sql import SparkSession spark = SparkSession."><meta property="og:type" content="article"><meta property="og:url" content="https://www.pablomarcos.me/es/posts/master-en-biolog%C3%ADa-computacional/big-data/predicting-churn-risk/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-01T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-01T00:00:00+00:00"><meta name=description content="Predicting Churn Risk"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css><script src=https://cdn.counter.dev/script.js data-id=counter-analytics@loreak.org data-utcoffset=1></script>
<script data-goatcounter=https://n9zp7.goatcounter.com/count async src=/js/goat-counter.js></script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/es><img src=/images/main-logo_hu47450349114826056e2be89059cb78d7_20725_42x0_resize_box_3.png alt=Logo>
Pablo Marcos' Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><div id=theme-initialization style=display:none default-theme=system></div><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# onclick=enableLightTheme()><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# onclick=enableDarkTheme()><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# onclick=useSystemTheme()><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/main-logo_hu47450349114826056e2be89059cb78d7_20725_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/inverted-logo_hu54cab9b231ca4636ef2fd30ef75af799_11321_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/es/search><input type=text name=keyword placeholder=B칰squeda data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/es/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/es/posts/concursos/>Concursos</a><ul><li><a href=/es/posts/concursos/centrodelenguas/ title="Centro de Lenguas 2020">Centro de Lenguas 2020</a></li><li><a href=/es/posts/concursos/vinoyaceite2020/ title="Etiquetas ETSIAAB 2020">Etiquetas ETSIAAB 2020</a></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/concursos/season-of-kde-2021/>Season of KDE 2021</a><ul><li><a href=/es/posts/concursos/season-of-kde-2021/sok-final-status-report/ title="Informe Final">Informe Final</a></li><li><a href=/es/posts/concursos/season-of-kde-2021/sok-report-april/ title="SoK 2021 Abril">SoK 2021 Abril</a></li><li><a href=/es/posts/concursos/season-of-kde-2021/sok-report-january/ title="SoK 2021 Enero">SoK 2021 Enero</a></li><li><a href=/es/posts/concursos/season-of-kde-2021/sok-report-february/ title="SoK 2021 Febrero">SoK 2021 Febrero</a></li><li><a href=/es/posts/concursos/season-of-kde-2021/sok-report-march/ title="SoK 2021 Marzo">SoK 2021 Marzo</a></li></ul></li><li><a href=/es/posts/concursos/season-of-kde-2022/ title="Season of KDE 2022">Season of KDE 2022</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/es/posts/master-en-biolog%C3%ADa-computacional/>Master en Bioinform치tica</a><ul class=active><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/readme/ title=README>README</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/>Big Data</a><ul class=active><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/predicting-dog-food-spoiling/ title="Dog Food Spoiling">Dog Food Spoiling</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/dog-food-day/ title="Extra Point">Extra Point</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/hack-data/ title="Hack Data">Hack Data</a></li><li><a class=active href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/predicting-churn-risk/ title="Predicting Churn Risk">Predicting Churn Risk</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/predicting-crew-members/ title="Predicting Crew Members">Predicting Crew Members</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/walmart-stock-exercise/ title="Walmart Stock Exercise">Walmart Stock Exercise</a></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/final-project/>Final Project</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/final-project/annex-i-code/ title="Annex I - Code">Annex I - Code</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/final-project/paper/ title=ReadMe>ReadMe</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/biolog%C3%ADa-evolutiva/>Biolog칤a Evolutiva</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/biolog%C3%ADa-evolutiva/exercise-1/ title="Exercise 1">Exercise 1</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/biolog%C3%ADa-evolutiva/exercise-2/ title="Exercise 2">Exercise 2</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/biolog%C3%ADa-programable/>Biolog칤a Programable</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/biolog%C3%ADa-programable/essay/ title=Essay>Essay</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/biolog%C3%ADa-programable/presentation/ title=Presentation>Presentation</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/estad%C3%ADstica/>Estad칤stica</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/estad%C3%ADstica/assignment-1/ title="Assignment 1">Assignment 1</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/estad%C3%ADstica/assignment-2/ title="Assignment 2">Assignment 2</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/estad%C3%ADstica/assignment-3/ title="Assignment 3">Assignment 3</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/estad%C3%ADstica/lecture-notes/ title="Notas de Clase">Notas de Clase</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gab/>GAB</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gab/assignment-1/ title="Assignment 1">Assignment 1</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gab/assignment-2/ title="Assignment 2">Assignment 2</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gab/warning/ title=WARNING>WARNING</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gdav/>GDAV</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gdav/final-project/ title="Final Project">Final Project</a></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gdav/single-cell-genomics/>Single Cell Genomics</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gdav/single-cell-genomics/exercise-1/ title="Exercise 1">Exercise 1</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gdav/single-cell-genomics/exercise-2/ title="Exercise 2">Exercise 2</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gdav/single-cell-genomics/exercise-3/ title="Exercise 3">Exercise 3</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/gdav/single-cell-genomics/final-report/ title="Final Report">Final Report</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/knowledge-representation/>Knowledge Representation</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/knowledge-representation/paper/ title=Paper>Paper</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/knowledge-representation/presentation/ title=Presentation>Presentation</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/lead-discovery/>Lead Discovery</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/lead-discovery/annex-i-code/ title="Annex I - Code">Annex I - Code</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/lead-discovery/assignment-1/ title="Assignment 1">Assignment 1</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/lead-discovery/assignment-2/ title="Assignment 2">Assignment 2</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/lead-discovery/assignment-3/ title="Assignment 3">Assignment 3</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/bioinfo-programming-challenges/>Retos en Ruby</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/bioinfo-programming-challenges/assignment-1/ title="Assignment 1">Assignment 1</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/bioinfo-programming-challenges/assignment-2/ title="Assignment 2">Assignment 2</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/bioinfo-programming-challenges/assignment-3/ title="Assignment 3">Assignment 3</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/bioinfo-programming-challenges/assignment-4/ title="Assignment 4">Assignment 4</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/bioinfo-programming-challenges/assignment-5/ title="Assignment 5">Assignment 5</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/tfm/>Trabajo Fin de Master</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/tfm/cangraph-documentation/ title="CanGraph Documentation">CanGraph Documentation</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/tfm/cangraph-update/ title="CanGraph Update">CanGraph Update</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/tfm/ecsa-day-2022/ title="ECSA Day 2022">ECSA Day 2022</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/tfm/presentation/ title=Presentaci칩n>Presentaci칩n</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/tfm/thesis/ title=Tesis>Tesis</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/>Modelizaci칩n</a><ul><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/celular-automata/ title="Cellular Automata">Cellular Automata</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/seir-modified-model/ title="CoViD and Lockdowns">CoViD and Lockdowns</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/networks/ title=Erd칬s-R칠nyi>Erd칬s-R칠nyi</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/essay-on-free-will/ title="Essay on Free Will">Essay on Free Will</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/kuramoto-oscilators/ title="Kuramoto Oscilators">Kuramoto Oscilators</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/logistic-map/ title="Logistic Map">Logistic Map</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/beyond-erdos-renyi/ title="Preferential Attachment">Preferential Attachment</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/synchronization-of-fireflies/ title="Synchronization of Fireflies">Synchronization of Fireflies</a></li><li><a href=/es/posts/master-en-biolog%C3%ADa-computacional/modelizaci%C3%B3n-de-sistemas-biol%C3%B3gicos/sir-model/ title="The SIR Model">The SIR Model</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/es/posts/poesia/>Poes칤a</a><ul><li><a href=/es/posts/poesia/abrazo/ title=Abrazo>Abrazo</a></li><li><a href=/es/posts/poesia/invierno/ title="Ahora soy Invierno">Ahora soy Invierno</a></li><li><a href=/es/posts/poesia/amor/ title=Amor>Amor</a></li><li><a href=/es/posts/poesia/despedida/ title=Amor>Amor</a></li><li><a href=/es/posts/poesia/simetria/ title=Asimetrico>Asimetrico</a></li><li><a href=/es/posts/poesia/paso-de-cebra/ title="Atr칠vete a Cruzar">Atr칠vete a Cruzar</a></li><li><a href=/es/posts/poesia/a%C3%B1o-nuevo/ title="A침o Nuevo">A침o Nuevo</a></li><li><a href=/es/posts/poesia/cerezo/ title=Cerezo>Cerezo</a></li><li><a href=/es/posts/poesia/locos/ title="Ciegos y Locos">Ciegos y Locos</a></li><li><a href=/es/posts/poesia/ciudad/ title=Ciudad>Ciudad</a></li><li><a href=/es/posts/poesia/coincidencia/ title=Coincidencia>Coincidencia</a></li><li><a href=/es/posts/poesia/peligro/ title="Colisi칩n Inminente">Colisi칩n Inminente</a></li><li><a href=/es/posts/poesia/courage/ title=Coraje>Coraje</a></li><li><a href=/es/posts/poesia/david-revoy/ title="Cute Cats">Cute Cats</a></li><li><a href=/es/posts/poesia/eclipse/ title=Eclipse>Eclipse</a></li><li><a href=/es/posts/poesia/efecto-pigmalion/ title="Efecto Pigmali칩n">Efecto Pigmali칩n</a></li><li><a href=/es/posts/poesia/efimero/ title=Ef칤mero>Ef칤mero</a></li><li><a href=/es/posts/poesia/espinas/ title=Espinas>Espinas</a></li><li><a href=/es/posts/poesia/estro/ title=Estro>Estro</a></li><li><a href=/es/posts/poesia/fuego/ title="Fuego 游댠 游댠">Fuego 游댠 游댠</a></li><li><a href=/es/posts/poesia/fugaz/ title=Fugaz>Fugaz</a></li><li><a href=/es/posts/poesia/ginko/ title=Gingko>Gingko</a></li><li><a href=/es/posts/poesia/granada/ title=Granada>Granada</a></li><li><a href=/es/posts/poesia/guayaba/ title=Guayaba>Guayaba</a></li><li><a href=/es/posts/poesia/hechizo/ title=Hechizo>Hechizo</a></li><li><a href=/es/posts/poesia/hipocresia/ title=Hipocres칤a>Hipocres칤a</a></li><li><a href=/es/posts/poesia/horizontes/ title=Horizontes>Horizontes</a></li><li><a href=/es/posts/poesia/if-ants-rose-up/ title="If ants rose up">If ants rose up</a></li><li><a href=/es/posts/poesia/incertidumbre/ title=Incertidumbre>Incertidumbre</a></li><li><a href=/es/posts/poesia/introduccion/ title=Introducci칩n>Introducci칩n</a></li><li><a href=/es/posts/poesia/hermanos/ title="La Revoluci칩n">La Revoluci칩n</a></li><li><a href=/es/posts/poesia/metamorfosis/ title=Metamorfosis>Metamorfosis</a></li><li><a href=/es/posts/poesia/miedo/ title=Miedo>Miedo</a></li><li><a href=/es/posts/poesia/monta%C3%B1a-rusa/ title="Monta침a Rusa">Monta침a Rusa</a></li><li><a href=/es/posts/poesia/narciso/ title=Narciso>Narciso</a></li><li><a href=/es/posts/poesia/ojala/ title=Ojal치>Ojal치</a></li><li><a href=/es/posts/poesia/erase/ title="Once Upon a Time">Once Upon a Time</a></li><li><a href=/es/posts/poesia/orquesta/ title="Orquesta 游꿭 游꿬">Orquesta 游꿭 游꿬</a></li><li><a href=/es/posts/poesia/papel/ title=Papel>Papel</a></li><li><a href=/es/posts/poesia/philanthropy/ title=Philantropy>Philantropy</a></li><li><a href=/es/posts/poesia/pluma/ title=Plumas>Plumas</a></li><li><a href=/es/posts/poesia/pluton/ title=Plut칩n>Plut칩n</a></li><li><a href=/es/posts/poesia/mitologia/ title="Por fin, la Primavera">Por fin, la Primavera</a></li><li><a href=/es/posts/poesia/precipicio/ title=Precipicio>Precipicio</a></li><li><a href=/es/posts/poesia/pajaro/ title=P치jaro>P치jaro</a></li><li><a href=/es/posts/poesia/rarezas/ title=Rarezas>Rarezas</a></li><li><a href=/es/posts/poesia/reloj/ title=Reloj>Reloj</a></li><li><a href=/es/posts/poesia/renacer/ title=Renacer>Renacer</a></li><li><a href=/es/posts/poesia/rubato/ title=Rubato>Rubato</a></li><li><a href=/es/posts/poesia/simulaci%C3%B3n/ title=Simulaci칩n>Simulaci칩n</a></li><li><a href=/es/posts/poesia/soledad/ title=Soledad>Soledad</a></li><li><a href=/es/posts/poesia/sue%C3%B1o/ title=Sue침o>Sue침o</a></li><li><a href=/es/posts/poesia/sufragettes/ title=Sufragettes>Sufragettes</a></li><li><a href=/es/posts/poesia/tarde/ title=Tarde>Tarde</a></li><li><a href=/es/posts/poesia/teclado/ title=Teclado>Teclado</a></li><li><a href=/es/posts/poesia/tentacion/ title=Tentaci칩n>Tentaci칩n</a></li><li><a href=/es/posts/poesia/valor/ title=Valor>Valor</a></li><li><a href=/es/posts/poesia/verde/ title=Verde>Verde</a></li><li><a href=/es/posts/poesia/volver/ title=Volver>Volver</a></li><li><a href=/es/posts/poesia/basta/ title="Ya Basta">Ya Basta</a></li><li><a href=/es/posts/poesia/egoismo/ title=Ego칤smo>Ego칤smo</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/es/posts/master-en-biolog%C3%ADa-computacional/big-data/predicting-churn-risk/hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/avataaars_hu2c0487d45d6329fb914c802e2a63f853_31315_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Pablo Ignacio Marcos L칩pez</h5><p>lunes, 1 de noviembre de 2021</p></div><div class=title><h1>Predicting Churn Risk</h1></div><div class=taxonomy-terms><ul style=padding-left:0></ul></div><div class=post-content id=post-content><p>Your goal is to create a model that can predict whether a customer will churn (0 or 1) based on the features in <a href=https://www.kaggle.com/hassanamin/customer-churn>this dataset</a>. See the slides for more information.</p><div style=text-align:center><a href=./Predicting_Churn_Risk.ipynb target=_parent><img src=/posts/Imagenes/jupyter-badge.svg align=center width=20%></a></div><h4 id=initial-steps>Initial Steps</h4><p>First, we need to create the Spark Session</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>!</span>apt<span style=color:#f92672>-</span>get install openjdk<span style=color:#f92672>-</span><span style=color:#ae81ff>8</span><span style=color:#f92672>-</span>jdk<span style=color:#f92672>-</span>headless <span style=color:#f92672>-</span>qq <span style=color:#f92672>&gt;</span> <span style=color:#f92672>/</span>dev<span style=color:#f92672>/</span>null
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>!</span>wget <span style=color:#f92672>-</span>q https:<span style=color:#f92672>//</span>mirrors<span style=color:#f92672>.</span>sonic<span style=color:#f92672>.</span>net<span style=color:#f92672>/</span>apache<span style=color:#f92672>/</span>spark<span style=color:#f92672>/</span>spark<span style=color:#f92672>-</span><span style=color:#ae81ff>3.1.2</span><span style=color:#f92672>/</span>spark<span style=color:#f92672>-</span><span style=color:#ae81ff>3.1.2</span><span style=color:#f92672>-</span>bin<span style=color:#f92672>-</span>hadoop3<span style=color:#ae81ff>.2</span><span style=color:#f92672>.</span>tgz
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>!</span>tar xzf spark<span style=color:#f92672>-</span><span style=color:#ae81ff>3.1.2</span><span style=color:#f92672>-</span>bin<span style=color:#f92672>-</span>hadoop3<span style=color:#ae81ff>.2</span><span style=color:#f92672>.</span>tgz
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>!</span>pip install <span style=color:#f92672>-</span>q findspark
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>environ[<span style=color:#e6db74>&#34;JAVA_HOME&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/usr/lib/jvm/java-8-openjdk-amd64&#34;</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>environ[<span style=color:#e6db74>&#34;SPARK_HOME&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/content/spark-3.1.2-bin-hadoop3.2&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> findspark
</span></span><span style=display:flex><span>findspark<span style=color:#f92672>.</span>init()
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.sql <span style=color:#f92672>import</span> SparkSession
</span></span><span style=display:flex><span>spark <span style=color:#f92672>=</span> SparkSession<span style=color:#f92672>.</span>builder<span style=color:#f92672>.</span>master(<span style=color:#e6db74>&#34;local[*]&#34;</span>)<span style=color:#f92672>.</span>getOrCreate()
</span></span></code></pre></div><p>Afterwards, we can read the file and inspect it</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#Please drop the file in the environment&#39;s &#39;Files&#39; panel</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>options(header<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span>, inferSchema<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span>)<span style=color:#f92672>.</span>csv(<span style=color:#e6db74>&#34;/content/customer_churn.csv&#34;</span>)
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>describe()<span style=color:#f92672>.</span>toPandas()
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>summary</th><th>Names</th><th>Age</th><th>Total_Purchase</th><th>Account_Manager</th><th>Years</th><th>Num_Sites</th><th>Onboard_date</th><th>Location</th><th>Company</th><th>Churn</th></tr></thead><tbody><tr><th>0</th><td>count</td><td>900</td><td>900</td><td>900</td><td>900</td><td>900</td><td>900</td><td>900</td><td>900</td><td>900</td><td>900</td></tr><tr><th>1</th><td>mean</td><td>None</td><td>41.81666666666667</td><td>10062.82403333334</td><td>0.4811111111111111</td><td>5.27315555555555</td><td>8.587777777777777</td><td>None</td><td>None</td><td>None</td><td>0.16666666666666666</td></tr><tr><th>2</th><td>stddev</td><td>None</td><td>6.127560416916251</td><td>2408.644531858096</td><td>0.4999208935073339</td><td>1.274449013194616</td><td>1.7648355920350969</td><td>None</td><td>None</td><td>None</td><td>0.3728852122772358</td></tr><tr><th>3</th><td>min</td><td>Aaron King</td><td>22.0</td><td>100.0</td><td>0</td><td>1.0</td><td>3.0</td><td>2006-01-02 04:16:13</td><td>00103 Jeffrey Crest Apt. 205 Padillaville, IA ...</td><td>Abbott-Thompson</td><td>0</td></tr><tr><th>4</th><td>max</td><td>Zachary Walsh</td><td>65.0</td><td>18026.01</td><td>1</td><td>9.15</td><td>14.0</td><td>2016-12-28 04:07:38</td><td>Unit 9800 Box 2878 DPO AA 75157</td><td>Zuniga, Clark and Shaffer</td><td>1</td></tr></tbody></table></div><h4 id=deciding-on-the-features-of-the-model>Deciding on the features of the Model</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#To see which columns we wish to select, we do:</span>
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>printSchema()
</span></span></code></pre></div><pre><code>root
 |-- Names: string (nullable = true)
 |-- Age: double (nullable = true)
 |-- Total_Purchase: double (nullable = true)
 |-- Account_Manager: integer (nullable = true)
 |-- Years: double (nullable = true)
 |-- Num_Sites: double (nullable = true)
 |-- Onboard_date: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- Company: string (nullable = true)
 |-- Churn: integer (nullable = true)
</code></pre><p>Here, we have to think wether it is work to index some columns: Both company name and location are pretty much unique, so I see no use for indexing them, although it could be interesting (but far too complicated) to index by country, for instance. I could also index the date by year, or add it to the model as datetime variable type, but, since I dont recall how to tell spark to accept a column as datetime (cant get .to_date() to work :/ ) I will leave it out for now.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#And we proceed to select them:</span>
</span></span><span style=display:flex><span>mycols <span style=color:#f92672>=</span>  df<span style=color:#f92672>.</span>select([<span style=color:#e6db74>&#39;Churn&#39;</span>, <span style=color:#e6db74>&#39;Age&#39;</span>, <span style=color:#e6db74>&#39;Total_Purchase&#39;</span>, <span style=color:#e6db74>&#39;Years&#39;</span>, <span style=color:#e6db74>&#39;Num_sites&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#75715e>#Hint: since &#39;Account_Manager&#39; is currently selected as random, we dont have to select it :p</span>
</span></span><span style=display:flex><span>final_train <span style=color:#f92672>=</span> mycols<span style=color:#f92672>.</span>na<span style=color:#f92672>.</span>drop()
</span></span></code></pre></div><h4 id=preparing-the-data>Preparing the data</h4><p>Since this dataset did not provide us with a &rsquo;train&rsquo; and a &rsquo;test&rsquo; sub-database, we need to manually make the divission ourselves. Thus:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>(train, test) <span style=color:#f92672>=</span> final_train<span style=color:#f92672>.</span>randomSplit([<span style=color:#ae81ff>0.7</span>,<span style=color:#ae81ff>0.3</span>])
</span></span><span style=display:flex><span>train<span style=color:#f92672>.</span>describe()<span style=color:#f92672>.</span>show(), test<span style=color:#f92672>.</span>describe()<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><pre><code>+-------+-------------------+------------------+------------------+------------------+------------------+
|summary|              Churn|               Age|    Total_Purchase|             Years|         Num_sites|
+-------+-------------------+------------------+------------------+------------------+------------------+
|  count|                604|               604|               604|               604|               604|
|   mean| 0.1456953642384106|41.764900662251655|10058.752913907281|  5.24854304635762| 8.509933774834437|
| stddev|0.35309296232693316| 6.293619382523293|2443.5585608960027|1.2693878324304124|1.6725966135800687|
|    min|                  0|              22.0|             100.0|               1.0|               4.0|
|    max|                  1|              65.0|          16955.76|              9.15|              13.0|
+-------+-------------------+------------------+------------------+------------------+------------------+

+-------+-------------------+-----------------+------------------+------------------+-----------------+
|summary|              Churn|              Age|    Total_Purchase|             Years|        Num_sites|
+-------+-------------------+-----------------+------------------+------------------+-----------------+
|  count|                296|              296|               296|               296|              296|
|   mean|0.20945945945945946| 41.9222972972973|10071.131317567566|5.3233783783783775|8.746621621621621|
| stddev|0.40761195202746325|5.782853919155999| 2339.838924409756| 1.285407304203774|1.932765316381917|
|    min|                  0|             27.0|            3263.0|              1.81|              3.0|
|    max|                  1|             58.0|          18026.01|              8.84|             14.0|
+-------+-------------------+-----------------+------------------+------------------+-----------------+






(None, None)
</code></pre><h4 id=creating-the-model>Creating the model</h4><p>Since it seems like the divission was correctly made, and like we have enough items both in the train and test dataframes, we can proceed to building the model based on the train data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.ml.feature <span style=color:#f92672>import</span> (VectorAssembler, OneHotEncoder, VectorIndexer, StringIndexer)
</span></span><span style=display:flex><span>assembler <span style=color:#f92672>=</span> VectorAssembler(inputCols<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Age&#39;</span>, <span style=color:#e6db74>&#39;Total_Purchase&#39;</span>, <span style=color:#e6db74>&#39;Years&#39;</span>, <span style=color:#e6db74>&#39;Num_sites&#39;</span>],
</span></span><span style=display:flex><span>                            outputCol<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;features&#39;</span>)
</span></span></code></pre></div><p>Interesting to know is that we can use:</p><pre tabindex=0><code>from pyspark.ml.feature import (VectorAssembler, OneHotEncoder, VectorIndexer, StringIndexer)

gender_indexer = StringIndexer(inputCol=&#39;Sex&#39;, outputCol=&#39;SexIndex&#39;)
gender_encoder = OneHotEncoder(inputCol=&#39;SexIndex&#39;, outputCol=&#39;SexVec&#39;)

embarked_indexer = StringIndexer(inputCol=&#39;Embarked&#39;, outputCol=&#39;EmbarkedIndex&#39;)
embarked_encoder = OneHotEncoder(inputCol=&#39;EmbarkedIndex&#39;, outputCol=&#39;EmbarkedVec&#39;)
</code></pre><p>To index vectors, and then add this to pipeline and assembler:</p><pre tabindex=0><code>assembler = VectorAssembler(inputCols=[&#39;Pclass&#39;,&#39;SexVec&#39;,&#39;Age&#39;,&#39;SibSp&#39;,&#39;Parch&#39;,&#39;Fare&#39;,&#39;EmbarkedVec&#39;],
                            outputCol=&#39;features&#39;)

pipeline = Pipeline(stages=[gender_indexer, embarked_indexer, gender_encoder, embarked_encoder, assembler, lr])
</code></pre><p>To work with parameters such as sex or others; however, as I have discussed previously, I will not use this here.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.ml.classification <span style=color:#f92672>import</span> LogisticRegression
</span></span><span style=display:flex><span>lr <span style=color:#f92672>=</span> LogisticRegression(featuresCol<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;features&#39;</span>, labelCol<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Churn&#39;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.ml <span style=color:#f92672>import</span> Pipeline
</span></span><span style=display:flex><span>pipeline <span style=color:#f92672>=</span> Pipeline(stages<span style=color:#f92672>=</span>[assembler, lr])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model <span style=color:#f92672>=</span> pipeline<span style=color:#f92672>.</span>fit(train)
</span></span></code></pre></div><p>Once we have developed the model, we curate the test data and use this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>curated_test <span style=color:#f92672>=</span> test<span style=color:#f92672>.</span>na<span style=color:#f92672>.</span>drop()
</span></span><span style=display:flex><span>predictions <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>transform(curated_test)
</span></span></code></pre></div><h4 id=visualizing-the-results>Visualizing the results</h4><p>Lets see the results!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>predictions<span style=color:#f92672>.</span>toPandas()
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Churn</th><th>Age</th><th>Total_Purchase</th><th>Years</th><th>Num_sites</th><th>features</th><th>rawPrediction</th><th>probability</th><th>prediction</th></tr></thead><tbody><tr><th>0</th><td>0</td><td>27.0</td><td>8628.80</td><td>5.30</td><td>7.0</td><td>[27.0, 8628.8, 5.3, 7.0]</td><td>[6.675936689418812, -6.675936689418812]</td><td>[0.9987406968746404, 0.001259303125359601]</td><td>0.0</td></tr><tr><th>1</th><td>0</td><td>28.0</td><td>9090.43</td><td>5.74</td><td>10.0</td><td>[28.0, 9090.43, 5.74, 10.0]</td><td>[2.1718950670750665, -2.1718950670750665]</td><td>[0.8976971350218025, 0.10230286497819752]</td><td>0.0</td></tr><tr><th>2</th><td>0</td><td>29.0</td><td>9617.59</td><td>5.49</td><td>8.0</td><td>[29.0, 9617.59, 5.49, 8.0]</td><td>[4.976543878227016, -4.976543878227016]</td><td>[0.9931493932780102, 0.006850606721989783]</td><td>0.0</td></tr><tr><th>3</th><td>0</td><td>29.0</td><td>10203.18</td><td>5.82</td><td>8.0</td><td>[29.0, 10203.18, 5.82, 8.0]</td><td>[4.801549127250805, -4.801549127250805]</td><td>[0.9918499609427239, 0.00815003905727607]</td><td>0.0</td></tr><tr><th>4</th><td>0</td><td>30.0</td><td>13473.35</td><td>3.84</td><td>10.0</td><td>[30.0, 13473.35, 3.84, 10.0]</td><td>[2.633769753642472, -2.633769753642472]</td><td>[0.9330035738020525, 0.06699642619794755]</td><td>0.0</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>291</th><td>1</td><td>50.0</td><td>14398.89</td><td>5.54</td><td>12.0</td><td>[50.0, 14398.89, 5.54, 12.0]</td><td>[-2.6224366916584323, 2.6224366916584323]</td><td>[0.06770831797659854, 0.9322916820234015]</td><td>1.0</td></tr><tr><th>292</th><td>1</td><td>51.0</td><td>8100.43</td><td>4.92</td><td>13.0</td><td>[51.0, 8100.43, 4.92, 13.0]</td><td>[-3.522746635680445, 3.522746635680445]</td><td>[0.02867190349642679, 0.9713280965035732]</td><td>1.0</td></tr><tr><th>293</th><td>1</td><td>55.0</td><td>5024.52</td><td>8.11</td><td>9.0</td><td>[55.0, 5024.52, 8.11, 9.0]</td><td>[0.4878396300738217, -0.4878396300738217]</td><td>[0.619597372506964, 0.380402627493036]</td><td>0.0</td></tr><tr><th>294</th><td>1</td><td>56.0</td><td>12217.95</td><td>5.79</td><td>11.0</td><td>[56.0, 12217.95, 5.79, 11.0]</td><td>[-1.7215722913002764, 1.7215722913002764]</td><td>[0.15166875344376754, 0.8483312465562325]</td><td>1.0</td></tr><tr><th>295</th><td>1</td><td>58.0</td><td>9703.93</td><td>5.16</td><td>11.0</td><td>[58.0, 9703.93, 5.16, 11.0]</td><td>[-1.4845273670253718, 1.4845273670253718]</td><td>[0.18474456093726596, 0.815255439062734]</td><td>1.0</td></tr></tbody></table><p>296 rows 칑 9 columns</p></div><h4 id=evaluating-accuracy>Evaluating accuracy</h4><p>Now that we have made the predictions, lets evaluate the accuracy of our prediction model:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.ml.evaluation <span style=color:#f92672>import</span> BinaryClassificationEvaluator
</span></span><span style=display:flex><span>evaluator <span style=color:#f92672>=</span> BinaryClassificationEvaluator(rawPredictionCol<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;prediction&#39;</span>, labelCol<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Churn&#39;</span>)
</span></span><span style=display:flex><span>acc <span style=color:#f92672>=</span> evaluator<span style=color:#f92672>.</span>evaluate(predictions)
</span></span><span style=display:flex><span>acc
</span></span></code></pre></div><pre><code>0.738833746898263
</code></pre><p>As we can see, the precition model is not that great, but it works to an extent.As previously discussed, we may be able to improve the model by indexing other parameters.</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Compartir en:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f" target=_blank><i class="fab fa-facebook"></i></a>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f&text=Predicting%20Churn%20Risk&via=Pablo%20Marcos%27%20Blog" target=_blank><i class="fab fa-twitter"></i></a>
<a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f&title=Predicting%20Churn%20Risk" target=_blank><i class="fab fa-reddit"></i></a>
<a class="btn btn-sm tumblr-btn" href="https://www.tumblr.com/share/link?url=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f&name=Predicting%20Churn%20Risk" target=_blank><i class="fab fa-tumblr"></i></a>
<a class="btn btn-sm pocket-btn" href="https://getpocket.com/save?url=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f&title=Predicting%20Churn%20Risk" target=_blank><i class="fab fa-get-pocket"></i></a>
<a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f&title=Predicting%20Churn%20Risk" target=_blank><i class="fab fa-linkedin"></i></a>
<a class="btn btn-sm diaspora-btn" href="https://share.diasporafoundation.org/?title=Predicting%20Churn%20Risk&url=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f" rel=nofollow target=_blank><i class="fab fa-diaspora"></i></a>
<a class="btn btn-sm mastodon-btn" href="https://mastodon.social/share?text=Predicting%20Churn%20Risk - https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f" target=_blank><i class="fab fa-mastodon"></i></a>
<a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=Predicting%20Churn%20Risk https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f" target=_blank><i class="fab fa-whatsapp"></i></a>
<a class="btn btn-sm email-btn" href="mailto:?subject=Predicting%20Churn%20Risk&body=https%3a%2f%2fwww.pablomarcos.me%2fes%2fposts%2fmaster-en-biolog%25C3%25ADa-computacional%2fbig-data%2fpredicting-churn-risk%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://codeberg.org/FlyingFlamingo/pablomarcos.me/_edit/main/content/posts/Master%20en%20Biolog%c3%ada%20Computacional/Big%20Data/Predicting%20Churn%20Risk/index.es.md title="Mejorar esta p치gina" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Mejorar esta p치gina</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/hack-data/ title="Hack Data" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Anterior</div><div class=next-prev-text>Hack Data</div></a></div><div class="col-md-6 next-article"><a href=/es/posts/master-en-biolog%C3%ADa-computacional/big-data/predicting-crew-members/ title="Predicting Crew Members" class="btn btn-outline-info"><div>Siguiente <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Predicting Crew Members</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Contenido</h5><hr><div class=toc><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#initial-steps>Initial Steps</a></li><li><a href=#deciding-on-the-features-of-the-model>Deciding on the features of the Model</a></li><li><a href=#preparing-the-data>Preparing the data</a></li><li><a href=#creating-the-model>Creating the model</a></li><li><a href=#visualizing-the-results>Visualizing the results</a></li><li><a href=#evaluating-accuracy>Evaluating accuracy</a></li></ul></li></ul></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navegaci칩n</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.pablomarcos.me/es/#about>Sobre m칤</a></li><li class=nav-item><a class=smooth-scroll href=https://www.pablomarcos.me/es/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://www.pablomarcos.me/es/#experiences>Experiencia</a></li><li class=nav-item><a class=smooth-scroll href=https://www.pablomarcos.me/es/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://www.pablomarcos.me/es/#projects>Proyectos</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contacto</h5><ul><li><a href=mailto:web@pablomarcos.me target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>web@pablomarcos.me</span></a></li></ul></div><div class="col-md-4 col-sm-12"><p>Subscribirse</p><form method=post action=https://blogtrottr.com><div class=form-group><input type=email class=form-control name=btr_email placeholder="Ingrese email"><br><input type=hidden name=btr_url value=https://www.pablomarcos.me/es/index.xml>
<input type=hidden name=schedule_type value=1>
<small id=emailHelp class="form-text text-muted">Al ingresar su direcci칩n de correo electr칩nico, acepta recibir el bolet칤n de este sitio web.</small>
<button type=submit class="btn btn-info"> Enviar</button></div></form></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">춸 2020 Pablo Ignacio Marcos L칩pez</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Funcionando con
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script type=text/javascript src=/js/darkreader.js></script>
<script type=text/javascript src=/js/darkmode-darkreader.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script><link rel=stylesheet href=/katex/katex.min.css><script type=text/javascript defer src=/katex/katex.min.js></script>
<script type=text/javascript defer src=/katex/auto-render.min.js onload=renderMathInElement(document.body)>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})</script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script>
<script>kofiWidgetOverlay.draw("pablomarcos",{type:"floating-chat","floating-chat.donateButton.text":"Ap칩yame","floating-chat.donateButton.text-color":"#fff","floating-chat.donateButton.background-color":"#00b9fe"})</script></body></html>